/**
 * @preserve
 * FullCalendar v1.5.2
 * http://arshaw.com/fullcalendar/
 *
 * Use fullcalendar.css for basic styling.
 * For event drag & drop, requires jQuery UI draggable.
 * For event resizing, requires jQuery UI resizable.
 *
 * Copyright (c) 2011 Adam Shaw
 * Dual licensed under the MIT and GPL licenses, located in
 * MIT-LICENSE.txt and GPL-LICENSE.txt respectively.
 *
 * Date: Sun Aug 21 22:06:09 2011 -0700
 *
 */
 (function($,bp){var bq={defaultView:'month',aspectRatio:1.35,header:{left:'title',center:'',right:'today prev,next'},weekends:true,allDayDefault:true,ignoreTimezone:true,lazyFetching:true,startParam:'start',endParam:'end',titleFormat:{month:'MMMM yyyy',week:"MMM d[ yyyy]{ '&#8212;'[ MMM] d yyyy}",day:'dddd, MMM d, yyyy'},columnFormat:{month:'ddd',week:'ddd M/d',day:'dddd M/d'},timeFormat:{'':'h(:mm)t'},isRTL:false,firstDay:0,monthNames:['January','February','March','April','May','June','July','August','September','October','November','December'],monthNamesShort:['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'],dayNames:['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'],dayNamesShort:['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],buttonText:{prev:'&nbsp;&#9668;&nbsp;',next:'&nbsp;&#9658;&nbsp;',prevYear:'&nbsp;&lt;&lt;&nbsp;',nextYear:'&nbsp;&gt;&gt;&nbsp;',today:'today',month:'month',week:'week',day:'day'},theme:false,buttonIcons:{prev:'circle-triangle-w',next:'circle-triangle-e'},unselectAuto:true,dropAccept:'*'};var br={header:{left:'next,prev today',center:'',right:'title'},buttonText:{prev:'&nbsp;&#9658;&nbsp;',next:'&nbsp;&#9668;&nbsp;',prevYear:'&nbsp;&gt;&gt;&nbsp;',nextYear:'&nbsp;&lt;&lt;&nbsp;'},buttonIcons:{prev:'circle-triangle-e',next:'circle-triangle-w'}};var bs=$.fullCalendar={version:"1.5.2"};var bt=bs.views={};$.fn.fullCalendar=function(d){if(typeof d=='string'){var e=Array.prototype.slice.call(arguments,1);var f;this.each(function(){var a=$.data(this,'fullCalendar');if(a&&$.isFunction(a[d])){var r=a[d].apply(a,e);if(f===bp){f=r}if(d=='destroy'){$.removeData(this,'fullCalendar')}}});if(f!==bp){return f}return this}var g=d.eventSources||[];delete d.eventSources;if(d.events){g.push(d.events);delete d.events}d=$.extend(true,{},bq,(d.isRTL||d.isRTL===bp&&bq.isRTL)?br:{},d);this.each(function(i,a){var b=$(a);var c=new Calendar(b,d,g);b.data('fullCalendar',c);c.render()});return this};function setDefaults(d){$.extend(true,bq,d)}function Calendar(f,g,h){var t=this;t.options=g;t.render=render;t.destroy=destroy;t.refetchEvents=refetchEvents;t.reportEvents=reportEvents;t.reportEventChange=reportEventChange;t.rerenderEvents=rerenderEvents;t.changeView=changeView;t.select=select;t.unselect=unselect;t.prev=prev;t.next=next;t.prevYear=prevYear;t.nextYear=nextYear;t.today=today;t.gotoDate=gotoDate;t.incrementDate=incrementDate;t.formatDate=function(a,b){return formatDate(a,b,g)};t.formatDates=function(a,b,c){return formatDates(a,b,c,g)};t.getDate=getDate;t.getView=getView;t.option=option;t.trigger=trigger;EventManager.call(t,g,h);var j=t.isFetchNeeded;var k=t.fetchEvents;var l=f[0];var m;var n;var o;var p;var q;var r={};var s;var u;var v;var w=0;var x=0;var y=new Date();var z=[];var A;setYMD(y,g.year,g.month,g.date);function render(a){if(!o){initialRender()}else{calcSize();markSizesDirty();markEventsDirty();renderView(a)}}function initialRender(){p=g.theme?'ui':'fc';f.addClass('fc');if(g.isRTL){f.addClass('fc-rtl')}if(g.theme){f.addClass('ui-widget')}o=$("<div class='fc-content' style='position:relative'/>").prependTo(f);m=new Header(t,g);n=m.render();if(n){f.prepend(n)}changeView(g.defaultView);$(window).resize(windowResize);if(!bodyVisible()){lateRender()}}function lateRender(){setTimeout(function(){if(!q.start&&bodyVisible()){renderView()}},0)}function destroy(){$(window).unbind('resize',windowResize);m.destroy();o.remove();f.removeClass('fc fc-rtl ui-widget')}function elementVisible(){return l.offsetWidth!==0}function bodyVisible(){return $('body')[0].offsetWidth!==0}function changeView(a){if(!q||a!=q.name){x++;unselect();var b=q;var c;if(b){(b.beforeHide||noop)();setMinHeight(o,o.height());b.element.hide()}else{setMinHeight(o,1)}o.css('overflow','hidden');q=r[a];if(q){q.element.show()}else{q=r[a]=new bt[a](c=v=$("<div class='fc-view fc-view-"+a+"' style='position:absolute'/>").appendTo(o),t)}if(b){m.deactivateButton(b.name)}m.activateButton(a);renderView();o.css('overflow','');if(b){setMinHeight(o,1)}if(!c){(q.afterShow||noop)()}x--}}function renderView(a){if(elementVisible()){x++;unselect();if(u===bp){calcSize()}var b=false;if(!q.start||a||y<q.start||y>=q.end){q.render(y,a||0);setSize(true);b=true}else if(q.sizeDirty){q.clearEvents();setSize();b=true}else if(q.eventsDirty){q.clearEvents();b=true}q.sizeDirty=false;q.eventsDirty=false;updateEvents(b);s=f.outerWidth();m.updateTitle(q.title);var c=new Date();if(c>=q.start&&c<q.end){m.disableButton('today')}else{m.enableButton('today')}x--;q.trigger('viewDisplay',l)}}function updateSize(){markSizesDirty();if(elementVisible()){calcSize();setSize();unselect();q.clearEvents();q.renderEvents(z);q.sizeDirty=false}}function markSizesDirty(){$.each(r,function(i,a){a.sizeDirty=true})}function calcSize(){if(g.contentHeight){u=g.contentHeight}else if(g.height){u=g.height-(n?n.height():0)-vsides(o)}else{u=Math.round(o.width()/Math.max(g.aspectRatio,.5))}}function setSize(a){x++;q.setHeight(u,a);if(v){v.css('position','relative');v=null}q.setWidth(o.width(),a);x--}function windowResize(){if(!x){if(q.start){var a=++w;setTimeout(function(){if(a==w&&!x&&elementVisible()){if(s!=(s=f.outerWidth())){x++;updateSize();q.trigger('windowResize',l);x--}}},200)}else{lateRender()}}}function updateEvents(a){if(!g.lazyFetching||j(q.visStart,q.visEnd)){refetchEvents()}else if(a){rerenderEvents()}}function refetchEvents(){k(q.visStart,q.visEnd)}function reportEvents(a){z=a;rerenderEvents()}function reportEventChange(a){rerenderEvents(a)}function rerenderEvents(a){markEventsDirty();if(elementVisible()){q.clearEvents();q.renderEvents(z,a);q.eventsDirty=false}}function markEventsDirty(){$.each(r,function(i,a){a.eventsDirty=true})}function select(a,b,c){q.select(a,b,c===bp?true:c)}function unselect(){if(q){q.unselect()}}function prev(){renderView(-1)}function next(){renderView(1)}function prevYear(){addYears(y,-1);renderView()}function nextYear(){addYears(y,1);renderView()}function today(){y=new Date();renderView()}function gotoDate(a,b,c){if(a instanceof Date){y=cloneDate(a)}else{setYMD(y,a,b,c)}renderView()}function incrementDate(a,b,c){if(a!==bp){addYears(y,a)}if(b!==bp){addMonths(y,b)}if(c!==bp){addDays(y,c)}renderView()}function getDate(){return cloneDate(y)}function getView(){return q}function option(a,b){if(b===bp){return g[a]}if(a=='height'||a=='contentHeight'||a=='aspectRatio'){g[a]=b;updateSize()}}function trigger(a,b){if(g[a]){return g[a].apply(b||l,Array.prototype.slice.call(arguments,2))}}if(g.droppable){$(document).bind('dragstart',function(a,b){var c=a.target;var e=$(c);if(!e.parents('.fc').length){var d=g.dropAccept;if($.isFunction(d)?d.call(c,e):e.is(d)){A=c;q.dragStart(A,a,b)}}}).bind('dragstop',function(a,b){if(A){q.dragStop(A,a,b);A=null}})}}function Header(l,m){var t=this;t.render=render;t.destroy=destroy;t.updateTitle=updateTitle;t.activateButton=activateButton;t.deactivateButton=deactivateButton;t.disableButton=disableButton;t.enableButton=enableButton;var n=$([]);var o;function render(){o=m.theme?'ui':'fc';var a=m.header;if(a){n=$("<table class='fc-header' style='width:100%'/>").append($("<tr/>").append(renderSection('left')).append(renderSection('center')).append(renderSection('right')));return n}}function destroy(){n.remove()}function renderSection(h){var e=$("<td class='fc-header-"+h+"'/>");var k=m.header[h];if(k){$.each(k.split(' '),function(i){if(i>0){e.append("<span class='fc-header-space'/>")}var g;$.each(this.split(','),function(j,a){if(a=='title'){e.append("<span class='fc-header-title'><h2>&nbsp;</h2></span>");if(g){g.addClass(o+'-corner-right')}g=null}else{var b;if(l[a]){b=l[a]}else if(bt[a]){b=function(){f.removeClass(o+'-state-hover');l.changeView(a)}}if(b){var c=m.theme?smartProperty(m.buttonIcons,a):null;var d=smartProperty(m.buttonText,a);var f=$("<span class='fc-button fc-button-"+a+" "+o+"-state-default'>"+"<span class='fc-button-inner'>"+"<span class='fc-button-content'>"+(c?"<span class='fc-icon-wrap'>"+"<span class='ui-icon ui-icon-"+c+"'/>"+"</span>":d)+"</span>"+"<span class='fc-button-effect'><span></span></span>"+"</span>"+"</span>");if(f){f.click(function(){if(!f.hasClass(o+'-state-disabled')){b()}}).mousedown(function(){f.not('.'+o+'-state-active').not('.'+o+'-state-disabled').addClass(o+'-state-down')}).mouseup(function(){f.removeClass(o+'-state-down')}).hover(function(){f.not('.'+o+'-state-active').not('.'+o+'-state-disabled').addClass(o+'-state-hover')},function(){f.removeClass(o+'-state-hover').removeClass(o+'-state-down')}).appendTo(e);if(!g){f.addClass(o+'-corner-left')}g=f}}}});if(g){g.addClass(o+'-corner-right')}})}return e}function updateTitle(a){n.find('h2').html(a)}function activateButton(a){n.find('span.fc-button-'+a).addClass(o+'-state-active')}function deactivateButton(a){n.find('span.fc-button-'+a).removeClass(o+'-state-active')}function disableButton(a){n.find('span.fc-button-'+a).addClass(o+'-state-disabled')}function enableButton(a){n.find('span.fc-button-'+a).removeClass(o+'-state-disabled')}}bs.sourceNormalizers=[];bs.sourceFetchers=[];var bu={dataType:'json',cache:false};var bv=1;function EventManager(p,q){var t=this;t.isFetchNeeded=isFetchNeeded;t.fetchEvents=fetchEvents;t.addEventSource=addEventSource;t.removeEventSource=removeEventSource;t.updateEvent=updateEvent;t.renderEvent=renderEvent;t.removeEvents=removeEvents;t.clientEvents=clientEvents;t.normalizeEvent=normalizeEvent;var r=t.trigger;var s=t.getView;var u=t.reportEvents;var v={events:[]};var w=[v];var x,rangeEnd;var y=0;var z=0;var A=0;var B=[];for(var i=0;i<q.length;i++){_addEventSource(q[i])}function isFetchNeeded(a,b){return!x||a<x||b>rangeEnd}function fetchEvents(a,b){x=a;rangeEnd=b;B=[];var c=++y;var d=w.length;z=d;for(var i=0;i<d;i++){fetchEventSource(w[i],c)}}function fetchEventSource(b,c){_fetchEventSource(b,function(a){if(c==y){if(a){for(var i=0;i<a.length;i++){a[i].source=b;normalizeEvent(a[i])}B=B.concat(a)}z--;if(!z){u(B)}}})}function _fetchEventSource(c,d){var i;var e=bs.sourceFetchers;var f;for(i=0;i<e.length;i++){f=e[i](c,x,rangeEnd,d);if(f===true){return}else if(typeof f=='object'){_fetchEventSource(f,d);return}}var g=c.events;if(g){if($.isFunction(g)){pushLoading();g(cloneDate(x),cloneDate(rangeEnd),function(a){d(a);popLoading()})}else if($.isArray(g)){d(g)}else{d()}}else{var h=c.url;if(h){var j=c.success;var k=c.error;var l=c.complete;var m=$.extend({},c.data||{});var n=firstDefined(c.startParam,p.startParam);var o=firstDefined(c.endParam,p.endParam);if(n){m[n]=Math.round(+x/1000)}if(o){m[o]=Math.round(+rangeEnd/1000)}pushLoading();$.ajax($.extend({},bu,c,{data:m,success:function(a){a=a||[];var b=applyAll(j,this,arguments);if($.isArray(b)){a=b}d(a)},error:function(){applyAll(k,this,arguments);d()},complete:function(){applyAll(l,this,arguments);popLoading()}}))}else{d()}}}function addEventSource(a){a=_addEventSource(a);if(a){z++;fetchEventSource(a,y)}}function _addEventSource(a){if($.isFunction(a)||$.isArray(a)){a={events:a}}else if(typeof a=='string'){a={url:a}}if(typeof a=='object'){normalizeSource(a);w.push(a);return a}}function removeEventSource(b){w=$.grep(w,function(a){return!isSourcesEqual(a,b)});B=$.grep(B,function(e){return!isSourcesEqual(e.source,b)});u(B)}function updateEvent(a){var i,len=B.length,e,defaultEventEnd=s().defaultEventEnd,startDelta=a.start-a._start,endDelta=a.end?(a.end-(a._end||defaultEventEnd(a))):0;for(i=0;i<len;i++){e=B[i];if(e._id==a._id&&e!=a){e.start=new Date(+e.start+startDelta);if(a.end){if(e.end){e.end=new Date(+e.end+endDelta)}else{e.end=new Date(+defaultEventEnd(e)+endDelta)}}else{e.end=null}e.title=a.title;e.url=a.url;e.allDay=a.allDay;e.className=a.className;e.editable=a.editable;e.color=a.color;e.backgroudColor=a.backgroudColor;e.borderColor=a.borderColor;e.textColor=a.textColor;normalizeEvent(e)}}normalizeEvent(a);u(B)}function renderEvent(a,b){normalizeEvent(a);if(!a.source){if(b){v.events.push(a);a.source=v}B.push(a)}u(B)}function removeEvents(a){if(!a){B=[];for(var i=0;i<w.length;i++){if($.isArray(w[i].events)){w[i].events=[]}}}else{if(!$.isFunction(a)){var b=a+'';a=function(e){return e._id==b}}B=$.grep(B,a,true);for(var i=0;i<w.length;i++){if($.isArray(w[i].events)){w[i].events=$.grep(w[i].events,a,true)}}}u(B)}function clientEvents(a){if($.isFunction(a)){return $.grep(B,a)}else if(a){a+='';return $.grep(B,function(e){return e._id==a})}return B}function pushLoading(){if(!A++){r('loading',null,true)}}function popLoading(){if(!--A){r('loading',null,false)}}function normalizeEvent(a){var b=a.source||{};var c=firstDefined(b.ignoreTimezone,p.ignoreTimezone);a._id=a._id||(a.id===bp?'_fc'+bv++:a.id+'');if(a.date){if(!a.start){a.start=a.date}delete a.date}a._start=cloneDate(a.start=parseDate(a.start,c));a.end=parseDate(a.end,c);if(a.end&&a.end<=a.start){a.end=null}a._end=a.end?cloneDate(a.end):null;if(a.allDay===bp){a.allDay=firstDefined(b.allDayDefault,p.allDayDefault)}if(a.className){if(typeof a.className=='string'){a.className=a.className.split(/\s+/)}}else{a.className=[]}}function normalizeSource(a){if(a.className){if(typeof a.className=='string'){a.className=a.className.split(/\s+/)}}else{a.className=[]}var b=bs.sourceNormalizers;for(var i=0;i<b.length;i++){b[i](a)}}function isSourcesEqual(a,b){return a&&b&&getSourcePrimitive(a)==getSourcePrimitive(b)}function getSourcePrimitive(a){return((typeof a=='object')?(a.events||a.url):'')||a}}bs.addDays=addDays;bs.cloneDate=cloneDate;bs.parseDate=parseDate;bs.parseISO8601=parseISO8601;bs.parseTime=parseTime;bs.formatDate=formatDate;bs.formatDates=formatDates;var bw=['sun','mon','tue','wed','thu','fri','sat'],DAY_MS=86400000,HOUR_MS=3600000,MINUTE_MS=60000;function addYears(d,n,a){d.setFullYear(d.getFullYear()+n);if(!a){clearTime(d)}return d}function addMonths(d,n,a){if(+d){var m=d.getMonth()+n,check=cloneDate(d);check.setDate(1);check.setMonth(m);d.setMonth(m);if(!a){clearTime(d)}while(d.getMonth()!=check.getMonth()){d.setDate(d.getDate()+(d<check?1:-1))}}return d}function addDays(d,n,a){if(+d){var b=d.getDate()+n,check=cloneDate(d);check.setHours(9);check.setDate(b);d.setDate(b);if(!a){clearTime(d)}fixDate(d,check)}return d}function fixDate(d,a){if(+d){while(d.getDate()!=a.getDate()){d.setTime(+d+(d<a?1:-1)*HOUR_MS)}}}function addMinutes(d,n){d.setMinutes(d.getMinutes()+n);return d}function clearTime(d){d.setHours(0);d.setMinutes(0);d.setSeconds(0);d.setMilliseconds(0);return d}function cloneDate(d,a){if(a){return clearTime(new Date(+d))}return new Date(+d)}function zeroDate(){var i=0,d;do{d=new Date(1970,i++,1)}while(d.getHours());return d}function skipWeekend(a,b,c){b=b||1;while(!a.getDay()||(c&&a.getDay()==1||!c&&a.getDay()==6)){addDays(a,b)}return a}function dayDiff(a,b){return Math.round((cloneDate(a,true)-cloneDate(b,true))/DAY_MS)}function setYMD(a,y,m,d){if(y!==bp&&y!=a.getFullYear()){a.setDate(1);a.setMonth(0);a.setFullYear(y)}if(m!==bp&&m!=a.getMonth()){a.setDate(1);a.setMonth(m)}if(d!==bp){a.setDate(d)}}function parseDate(s,a){if(typeof s=='object'){return s}if(typeof s=='number'){return new Date(s*1000)}if(typeof s=='string'){if(s.match(/^\d+(\.\d+)?$/)){return new Date(parseFloat(s)*1000)}if(a===bp){a=true}return parseISO8601(s,a)||(s?new Date(s):null)}return null}function parseISO8601(s,a){var m=s.match(/^([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2})(:?([0-9]{2}))?))?)?)?)?$/);if(!m){return null}var b=new Date(m[1],0,1);if(a||!m[13]){var c=new Date(m[1],0,1,9,0);if(m[3]){b.setMonth(m[3]-1);c.setMonth(m[3]-1)}if(m[5]){b.setDate(m[5]);c.setDate(m[5])}fixDate(b,c);if(m[7]){b.setHours(m[7])}if(m[8]){b.setMinutes(m[8])}if(m[10]){b.setSeconds(m[10])}if(m[12]){b.setMilliseconds(Number("0."+m[12])*1000)}fixDate(b,c)}else{b.setUTCFullYear(m[1],m[3]?m[3]-1:0,m[5]||1);b.setUTCHours(m[7]||0,m[8]||0,m[10]||0,m[12]?Number("0."+m[12])*1000:0);if(m[14]){var d=Number(m[16])*60+(m[18]?Number(m[18]):0);d*=m[15]=='-'?1:-1;b=new Date(+b+(d*60*1000))}}return b}function parseTime(s){if(typeof s=='number'){return s*60}if(typeof s=='object'){return s.getHours()*60+s.getMinutes()}var m=s.match(/(\d+)(?::(\d+))?\s*(\w+)?/);if(m){var h=parseInt(m[1],10);if(m[3]){h%=12;if(m[3].toLowerCase().charAt(0)=='p'){h+=12}}return h*60+(m[2]?parseInt(m[2],10):0)}}function formatDate(a,b,c){return formatDates(a,null,b,c)}function formatDates(a,b,d,e){e=e||bq;var f=a,otherDate=b,i,len=d.length,c,i2,formatter,res='';for(i=0;i<len;i++){c=d.charAt(i);if(c=="'"){for(i2=i+1;i2<len;i2++){if(d.charAt(i2)=="'"){if(f){if(i2==i+1){res+="'"}else{res+=d.substring(i+1,i2)}i=i2}break}}}else if(c=='('){for(i2=i+1;i2<len;i2++){if(d.charAt(i2)==')'){var g=formatDate(f,d.substring(i+1,i2),e);if(parseInt(g.replace(/\D/,''),10)){res+=g}i=i2;break}}}else if(c=='['){for(i2=i+1;i2<len;i2++){if(d.charAt(i2)==']'){var h=d.substring(i+1,i2);var g=formatDate(f,h,e);if(g!=formatDate(otherDate,h,e)){res+=g}i=i2;break}}}else if(c=='{'){f=b;otherDate=a}else if(c=='}'){f=a;otherDate=b}else{for(i2=len;i2>i;i2--){if(formatter=bx[d.substring(i,i2)]){if(f){res+=formatter(f,e)}i=i2-1;break}}if(i2==i){if(f){res+=c}}}}return res};var bx={s:function(d){return d.getSeconds()},ss:function(d){return zeroPad(d.getSeconds())},m:function(d){return d.getMinutes()},mm:function(d){return zeroPad(d.getMinutes())},h:function(d){return d.getHours()%12||12},hh:function(d){return zeroPad(d.getHours()%12||12)},H:function(d){return d.getHours()},HH:function(d){return zeroPad(d.getHours())},d:function(d){return d.getDate()},dd:function(d){return zeroPad(d.getDate())},ddd:function(d,o){return o.dayNamesShort[d.getDay()]},dddd:function(d,o){return o.dayNames[d.getDay()]},M:function(d){return d.getMonth()+1},MM:function(d){return zeroPad(d.getMonth()+1)},MMM:function(d,o){return o.monthNamesShort[d.getMonth()]},MMMM:function(d,o){return o.monthNames[d.getMonth()]},yy:function(d){return(d.getFullYear()+'').substring(2)},yyyy:function(d){return d.getFullYear()},t:function(d){return d.getHours()<12?'a':'p'},tt:function(d){return d.getHours()<12?'am':'pm'},T:function(d){return d.getHours()<12?'A':'P'},TT:function(d){return d.getHours()<12?'AM':'PM'},u:function(d){return formatDate(d,"yyyy-MM-dd'T'HH:mm:ss'Z'")},S:function(d){var a=d.getDate();if(a>10&&a<20){return'th'}return['st','nd','rd'][a%10-1]||'th'}};bs.applyAll=applyAll;function exclEndDay(a){if(a.end){return _exclEndDay(a.end,a.allDay)}else{return addDays(cloneDate(a.start),1)}}function _exclEndDay(a,b){a=cloneDate(a);return b||a.getHours()||a.getMinutes()?addDays(a,1):clearTime(a)}function segCmp(a,b){return(b.msLength-a.msLength)*100+(a.event.start-b.event.start)}function segsCollide(a,b){return a.end>b.start&&a.start<b.end}function sliceSegs(a,b,c,d){var e=[],i,len=a.length,event,eventStart,eventEnd,segStart,segEnd,isStart,isEnd;for(i=0;i<len;i++){event=a[i];eventStart=event.start;eventEnd=b[i];if(eventEnd>c&&eventStart<d){if(eventStart<c){segStart=cloneDate(c);isStart=false}else{segStart=eventStart;isStart=true}if(eventEnd>d){segEnd=cloneDate(d);isEnd=false}else{segEnd=eventEnd;isEnd=true}e.push({event:event,start:segStart,end:segEnd,isStart:isStart,isEnd:isEnd,msLength:segEnd-segStart})}}return e.sort(segCmp)}function stackSegs(a){var b=[],i,len=a.length,seg,j,collide,k;for(i=0;i<len;i++){seg=a[i];j=0;while(true){collide=false;if(b[j]){for(k=0;k<b[j].length;k++){if(segsCollide(b[j][k],seg)){collide=true;break}}}if(collide){j++}else{break}}if(b[j]){b[j].push(seg)}else{b[j]=[seg]}}return b}function lazySegBind(c,d,f){c.unbind('mouseover').mouseover(function(a){var b=a.target,e,i,seg;while(b!=this){e=b;b=b.parentNode}if((i=e._fci)!==bp){e._fci=bp;seg=d[i];f(seg.event,seg.element,seg);$(a.target).trigger(a)}a.stopPropagation()})}function setOuterWidth(a,b,c){for(var i=0,e;i<a.length;i++){e=$(a[i]);e.width(Math.max(0,b-hsides(e,c)))}}function setOuterHeight(a,b,c){for(var i=0,e;i<a.length;i++){e=$(a[i]);e.height(Math.max(0,b-vsides(e,c)))}}function hsides(a,b){return hpadding(a)+hborders(a)+(b?hmargins(a):0)}function hpadding(a){return(parseFloat($.curCSS(a[0],'paddingLeft',true))||0)+(parseFloat($.curCSS(a[0],'paddingRight',true))||0)}function hmargins(a){return(parseFloat($.curCSS(a[0],'marginLeft',true))||0)+(parseFloat($.curCSS(a[0],'marginRight',true))||0)}function hborders(a){return(parseFloat($.curCSS(a[0],'borderLeftWidth',true))||0)+(parseFloat($.curCSS(a[0],'borderRightWidth',true))||0)}function vsides(a,b){return vpadding(a)+vborders(a)+(b?vmargins(a):0)}function vpadding(a){return(parseFloat($.curCSS(a[0],'paddingTop',true))||0)+(parseFloat($.curCSS(a[0],'paddingBottom',true))||0)}function vmargins(a){return(parseFloat($.curCSS(a[0],'marginTop',true))||0)+(parseFloat($.curCSS(a[0],'marginBottom',true))||0)}function vborders(a){return(parseFloat($.curCSS(a[0],'borderTopWidth',true))||0)+(parseFloat($.curCSS(a[0],'borderBottomWidth',true))||0)}function setMinHeight(b,c){c=(typeof c=='number'?c+'px':c);b.each(function(i,a){a.style.cssText+=';min-height:'+c+';_height:'+c})}function noop(){}function cmp(a,b){return a-b}function arrayMax(a){return Math.max.apply(Math,a)}function zeroPad(n){return(n<10?'0':'')+n}function smartProperty(a,b){if(a[b]!==bp){return a[b]}var c=b.split(/(?=[A-Z])/),i=c.length-1,res;for(;i>=0;i--){res=a[c[i].toLowerCase()];if(res!==bp){return res}}return a['']}function htmlEscape(s){return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/'/g,'&#039;').replace(/"/g,'&quot;').replace(/\n/g,'<br />')}function cssKey(a){return a.id+'/'+a.className+'/'+a.style.cssText.replace(/(^|;)\s*(top|left|width|height)\s*:[^;]*/ig,'')}function disableTextSelection(a){a.attr('unselectable','on').css('MozUserSelect','none').bind('selectstart.ui',function(){return false})}function markFirstLast(e){e.children().removeClass('fc-first fc-last').filter(':first-child').addClass('fc-first').end().filter(':last-child').addClass('fc-last')}function setDayID(b,c){b.each(function(i,a){a.className=a.className.replace(/^fc-\w*/,'fc-'+bw[c.getDay()])})}function getSkinCss(a,b){var c=a.source||{};var d=a.color;var e=c.color;var f=b('eventColor');var g=a.backgroundColor||d||c.backgroundColor||e||b('eventBackgroundColor')||f;var h=a.borderColor||d||c.borderColor||e||b('eventBorderColor')||f;var i=a.textColor||c.textColor||b('eventTextColor');var j=[];if(g){j.push('background-color:'+g)}if(h){j.push('border-color:'+h)}if(i){j.push('color:'+i)}return j.join(';')}function applyAll(a,b,c){if($.isFunction(a)){a=[a]}if(a){var i;var d;for(i=0;i<a.length;i++){d=a[i].apply(b,c)||d}return d}}function firstDefined(){for(var i=0;i<arguments.length;i++){if(arguments[i]!==bp){return arguments[i]}}}bt.month=MonthView;function MonthView(j,k){var t=this;t.render=render;BasicView.call(t,j,k,'month');var l=t.opt;var m=t.renderBasic;var n=k.formatDate;function render(a,b){if(b){addMonths(a,b);a.setDate(1)}var c=cloneDate(a,true);c.setDate(1);var d=addMonths(cloneDate(c),1);var e=cloneDate(c);var f=cloneDate(d);var g=l('firstDay');var h=l('weekends')?0:1;if(h){skipWeekend(e);skipWeekend(f,-1,true)}addDays(e,-((e.getDay()-Math.max(g,h)+7)%7));addDays(f,(7-f.getDay()+Math.max(g,h))%7);var i=Math.round((f-e)/(DAY_MS*7));if(l('weekMode')=='fixed'){addDays(f,(6-i)*7);i=6}t.title=n(c,l('titleFormat'));t.start=c;t.end=d;t.visStart=e;t.visEnd=f;m(6,i,h?5:7,true)}}bt.basicWeek=BasicWeekView;function BasicWeekView(h,i){var t=this;t.render=render;BasicView.call(t,h,i,'basicWeek');var j=t.opt;var k=t.renderBasic;var l=i.formatDates;function render(a,b){if(b){addDays(a,b*7)}var c=addDays(cloneDate(a),-((a.getDay()-j('firstDay')+7)%7));var d=addDays(cloneDate(c),7);var e=cloneDate(c);var f=cloneDate(d);var g=j('weekends');if(!g){skipWeekend(e);skipWeekend(f,-1,true)}t.title=l(e,addDays(cloneDate(f),-1),j('titleFormat'));t.start=c;t.end=d;t.visStart=e;t.visEnd=f;k(1,1,g?7:5,false)}}bt.basicDay=BasicDayView;function BasicDayView(c,d){var t=this;t.render=render;BasicView.call(t,c,d,'basicDay');var e=t.opt;var f=t.renderBasic;var g=d.formatDate;function render(a,b){if(b){addDays(a,b);if(!e('weekends')){skipWeekend(a,b<0?-1:1)}}t.title=g(a,e('titleFormat'));t.start=t.visStart=cloneDate(a,true);t.end=t.visEnd=addDays(cloneDate(t.start),1);f(1,1,1,false)}}setDefaults({weekMode:'fixed'});function BasicView(k,l,m){var t=this;t.renderBasic=renderBasic;t.setHeight=setHeight;t.setWidth=setWidth;t.renderDayOverlay=renderDayOverlay;t.defaultSelectionEnd=defaultSelectionEnd;t.renderSelection=renderSelection;t.clearSelection=clearSelection;t.reportDayClick=reportDayClick;t.dragStart=dragStart;t.dragStop=dragStop;t.defaultEventEnd=defaultEventEnd;t.getHoverListener=function(){return M};t.colContentLeft=colContentLeft;t.colContentRight=colContentRight;t.dayOfWeekCol=dayOfWeekCol;t.dateCell=dateCell;t.cellDate=cellDate;t.cellIsAllDay=function(){return true};t.allDayRow=allDayRow;t.allDayBounds=allDayBounds;t.getRowCnt=function(){return K};t.getColCnt=function(){return colCnt};t.getColWidth=function(){return J};t.getDaySegmentContainer=function(){return G};View.call(t,k,l,m);OverlayManager.call(t);SelectionManager.call(t);BasicEventRenderer.call(t);var o=t.opt;var q=t.trigger;var u=t.clearEvents;var v=t.renderOverlay;var w=t.clearOverlays;var x=t.daySelectionMousedown;var y=l.formatDate;var z;var A;var B;var C;var D;var E;var F;var G;var H;var I;var J;var K,colCnt;var L;var M;var N;var O,dis,dit;var P;var Q;var R;var S;disableTextSelection(k.addClass('fc-grid'));function renderBasic(a,r,c,b){K=r;colCnt=c;updateOptions();var d=!B;if(d){buildSkeleton(a,b)}else{u()}updateCells(d)}function updateOptions(){O=o('isRTL');if(O){dis=-1;dit=colCnt-1}else{dis=1;dit=0}P=o('firstDay');Q=o('weekends')?0:1;R=o('theme')?'ui':'fc';S=o('columnFormat')}function buildSkeleton(a,b){var s;var c=R+"-widget-header";var d=R+"-widget-content";var i,j;var e;s="<table class='fc-border-separate' style='width:100%' cellspacing='0'>"+"<thead>"+"<tr>";for(i=0;i<colCnt;i++){s+="<th class='fc- "+c+"'/>"}s+="</tr>"+"</thead>"+"<tbody>";for(i=0;i<a;i++){s+="<tr class='fc-week"+i+"'>";for(j=0;j<colCnt;j++){s+="<td class='fc- "+d+" fc-day"+(i*colCnt+j)+"'>"+"<div>"+(b?"<div class='fc-day-number'/>":'')+"<div class='fc-day-content'>"+"<div style='position:relative'>&nbsp;</div>"+"</div>"+"</div>"+"</td>"}s+="</tr>"}s+="</tbody>"+"</table>";e=$(s).appendTo(k);z=e.find('thead');A=z.find('th');B=e.find('tbody');C=B.find('tr');D=B.find('td');E=D.filter(':first-child');F=C.eq(0).find('div.fc-day-content div');markFirstLast(z.add(z.find('tr')));markFirstLast(C);C.eq(0).addClass('fc-first');dayBind(D);G=$("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(k)}function updateCells(b){var c=b||K==1;var d=t.start.getMonth();var e=clearTime(new Date());var f;var g;var h;if(c){A.each(function(i,a){f=$(a);g=indexDate(i);f.html(y(g,S));setDayID(f,g)})}D.each(function(i,a){f=$(a);g=indexDate(i);if(g.getMonth()==d){f.removeClass('fc-other-month')}else{f.addClass('fc-other-month')}if(+g==+e){f.addClass(R+'-state-highlight fc-today')}else{f.removeClass(R+'-state-highlight fc-today')}f.find('div.fc-day-number').text(g.getDate());if(c){setDayID(f,g)}});C.each(function(i,a){h=$(a);if(i<K){h.show();if(i==K-1){h.addClass('fc-last')}else{h.removeClass('fc-last')}}else{h.hide()}})}function setHeight(b){I=b;var c=I-z.height();var d;var e;var f;if(o('weekMode')=='variable'){d=e=Math.floor(c/(K==1?2:6))}else{d=Math.floor(c/K);e=c-d*(K-1)}E.each(function(i,a){if(i<K){f=$(a);setMinHeight(f.find('> div'),(i==K-1?e:d)-vsides(f))}})}function setWidth(a){H=a;N.clear();J=Math.floor(H/colCnt);setOuterWidth(A.slice(0,-1),J)}function dayBind(a){a.click(dayClick).mousedown(x)}function dayClick(a){if(!o('selectable')){var b=parseInt(this.className.match(/fc\-day(\d+)/)[1]);var c=indexDate(b);q('dayClick',this,c,true,a)}}function renderDayOverlay(a,b,c){if(c){L.build()}var d=cloneDate(t.visStart);var e=addDays(cloneDate(d),colCnt);for(var i=0;i<K;i++){var f=new Date(Math.max(d,a));var g=new Date(Math.min(e,b));if(f<g){var h,colEnd;if(O){h=dayDiff(g,d)*dis+dit+1;colEnd=dayDiff(f,d)*dis+dit+1}else{h=dayDiff(f,d);colEnd=dayDiff(g,d)}dayBind(renderCellOverlay(i,h,i,colEnd-1))}addDays(d,7);addDays(e,7)}}function renderCellOverlay(a,b,c,d){var e=L.rect(a,b,c,d,k);return v(e,k)}function defaultSelectionEnd(a,b){return cloneDate(a)}function renderSelection(a,b,c){renderDayOverlay(a,addDays(cloneDate(b),1),true)}function clearSelection(){w()}function reportDayClick(a,b,c){var d=dateCell(a);var e=D[d.row*colCnt+d.col];q('dayClick',e,a,b,c)}function dragStart(b,c,d){M.start(function(a){w();if(a){renderCellOverlay(a.row,a.col,a.row,a.col)}},c)}function dragStop(a,b,c){var e=M.stop();w();if(e){var d=cellDate(e);q('drop',a,d,true,b,c)}}function defaultEventEnd(a){return cloneDate(a.start)}L=new CoordinateGrid(function(b,c){var e,n,p;A.each(function(i,a){e=$(a);n=e.offset().left;if(i){p[1]=n}p=[n];c[i]=p});p[1]=n+e.outerWidth();C.each(function(i,a){if(i<K){e=$(a);n=e.offset().top;if(i){p[1]=n}p=[n];b[i]=p}});p[1]=n+e.outerHeight()});M=new HoverListener(L);N=new HorizontalPositionCache(function(a){return F.eq(a)});function colContentLeft(a){return N.left(a)}function colContentRight(a){return N.right(a)}function dateCell(a){return{row:Math.floor(dayDiff(a,t.visStart)/7),col:dayOfWeekCol(a.getDay())}}function cellDate(a){return _cellDate(a.row,a.col)}function _cellDate(a,b){return addDays(cloneDate(t.visStart),a*7+b*dis+dit)}function indexDate(a){return _cellDate(Math.floor(a/colCnt),a%colCnt)}function dayOfWeekCol(a){return((a-Math.max(P,Q)+colCnt)%colCnt)*dis+dit}function allDayRow(i){return C.eq(i)}function allDayBounds(i){return{left:0,right:H}}}function BasicEventRenderer(){var t=this;t.renderEvents=renderEvents;t.compileDaySegs=compileSegs;t.clearEvents=clearEvents;t.bindDaySeg=bindDaySeg;DayEventRenderer.call(t);var l=t.opt;var m=t.trigger;var n=t.isEventDraggable;var o=t.isEventResizable;var p=t.reportEvents;var q=t.reportEventClear;var r=t.eventElementHandlers;var s=t.showEvents;var u=t.hideEvents;var v=t.eventDrop;var w=t.getDaySegmentContainer;var x=t.getHoverListener;var y=t.renderDayOverlay;var z=t.clearOverlays;var A=t.getRowCnt;var B=t.getColCnt;var C=t.renderDaySegs;var D=t.resizableDayEvent;function renderEvents(a,b){p(a);C(compileSegs(a),b)}function clearEvents(){q();w().empty()}function compileSegs(a){var b=A(),colCnt=B(),d1=cloneDate(t.visStart),d2=addDays(cloneDate(d1),colCnt),visEventsEnds=$.map(a,exclEndDay),i,row,j,level,k,seg,segs=[];for(i=0;i<b;i++){row=stackSegs(sliceSegs(a,visEventsEnds,d1,d2));for(j=0;j<row.length;j++){level=row[j];for(k=0;k<level.length;k++){seg=level[k];seg.row=i;seg.level=j;segs.push(seg)}}addDays(d1,7);addDays(d2,7)}return segs}function bindDaySeg(a,b,c){if(n(a)){draggableDayEvent(a,b)}if(c.isEnd&&o(a)){D(a,b,c)}r(a,b)}function draggableDayEvent(g,h){var i=x();var j;h.draggable({zIndex:9,delay:50,opacity:l('dragOpacity'),revertDuration:l('dragRevertDuration'),start:function(e,f){m('eventDragStart',h,g,e,f);u(g,h);i.start(function(a,b,c,d){h.draggable('option','revert',!a||!c&&!d);z();if(a){j=c*7+d*(l('isRTL')?-1:1);y(addDays(cloneDate(g.start),j),addDays(exclEndDay(g),j))}else{j=0}},e,'drag')},stop:function(a,b){i.stop();z();m('eventDragStop',h,g,a,b);if(j){v(this,g,j,0,g.allDay,a,b)}else{h.css('filter','');s(g,h)}}})}}bt.agendaWeek=AgendaWeekView;function AgendaWeekView(h,i){var t=this;t.render=render;AgendaView.call(t,h,i,'agendaWeek');var j=t.opt;var k=t.renderAgenda;var l=i.formatDates;function render(a,b){if(b){addDays(a,b*7)}var c=addDays(cloneDate(a),-((a.getDay()-j('firstDay')+7)%7));var d=addDays(cloneDate(c),7);var e=cloneDate(c);var f=cloneDate(d);var g=j('weekends');if(!g){skipWeekend(e);skipWeekend(f,-1,true)}t.title=l(e,addDays(cloneDate(f),-1),j('titleFormat'));t.start=c;t.end=d;t.visStart=e;t.visEnd=f;k(g?7:5)}}bt.agendaDay=AgendaDayView;function AgendaDayView(e,f){var t=this;t.render=render;AgendaView.call(t,e,f,'agendaDay');var g=t.opt;var h=t.renderAgenda;var i=f.formatDate;function render(a,b){if(b){addDays(a,b);if(!g('weekends')){skipWeekend(a,b<0?-1:1)}}var c=cloneDate(a,true);var d=addDays(cloneDate(c),1);t.title=i(a,g('titleFormat'));t.start=t.visStart=c;t.end=t.visEnd=d;h(1)}}setDefaults({allDaySlot:true,allDayText:'all-day',firstHour:6,slotMinutes:30,defaultEventMinutes:120,axisFormat:'h(:mm)tt',timeFormat:{agenda:'h:mm{ - h:mm}'},dragOpacity:{agenda:.5},minTime:0,maxTime:24});function AgendaView(l,m,o){var t=this;t.renderAgenda=renderAgenda;t.setWidth=setWidth;t.setHeight=setHeight;t.beforeHide=beforeHide;t.afterShow=afterShow;t.defaultEventEnd=defaultEventEnd;t.timePosition=timePosition;t.dayOfWeekCol=dayOfWeekCol;t.dateCell=dateCell;t.cellDate=cellDate;t.cellIsAllDay=cellIsAllDay;t.allDayRow=getAllDayRow;t.allDayBounds=allDayBounds;t.getHoverListener=function(){return bE};t.colContentLeft=colContentLeft;t.colContentRight=colContentRight;t.getDaySegmentContainer=function(){return L};t.getSlotSegmentContainer=function(){return Q};t.getMinMinute=function(){return bL};t.getMaxMinute=function(){return maxMinute};t.getBodyContent=function(){return P};t.getRowCnt=function(){return 1};t.getColCnt=function(){return bB};t.getColWidth=function(){return Z};t.getSlotHeight=function(){return bz};t.defaultSelectionEnd=defaultSelectionEnd;t.renderDayOverlay=renderDayOverlay;t.renderSelection=renderSelection;t.clearSelection=clearSelection;t.reportDayClick=reportDayClick;t.dragStart=dragStart;t.dragStop=dragStop;View.call(t,l,m,o);OverlayManager.call(t);SelectionManager.call(t);AgendaEventRenderer.call(t);var q=t.opt;var r=t.trigger;var u=t.clearEvents;var v=t.renderOverlay;var w=t.clearOverlays;var x=t.reportSelection;var y=t.unselect;var z=t.daySelectionMousedown;var A=t.slotSegHtml;var B=m.formatDate;var C;var D;var E;var F;var G;var H;var I;var J;var K;var L;var M;var N;var O;var P;var Q;var R;var S;var T;var U;var V;var W;var X;var Y;var Z;var by;var bz;var bA;var bB;var bC;var bD;var bE;var bF;var bG={};var bH;var bI;var bJ;var bK,dis,dit;var bL,maxMinute;var bM;disableTextSelection(l.addClass('fc-agenda'));function renderAgenda(c){bB=c;updateOptions();if(!C){buildSkeleton()}else{u()}updateCells()}function updateOptions(){bH=q('theme')?'ui':'fc';bJ=q('weekends')?0:1;bI=q('firstDay');if(bK=q('isRTL')){dis=-1;dit=bB-1}else{dis=1;dit=0}bL=parseTime(q('minTime'));maxMinute=parseTime(q('maxTime'));bM=q('columnFormat')}function buildSkeleton(){var a=bH+"-widget-header";var b=bH+"-widget-content";var s;var i;var d;var c;var e;var f=q('slotMinutes')%15==0;s="<table style='width:100%' class='fc-agenda-days fc-border-separate' cellspacing='0'>"+"<thead>"+"<tr>"+"<th class='fc-agenda-axis "+a+"'>&nbsp;</th>";for(i=0;i<bB;i++){s+="<th class='fc- fc-col"+i+' '+a+"'/>"}s+="<th class='fc-agenda-gutter "+a+"'>&nbsp;</th>"+"</tr>"+"</thead>"+"<tbody>"+"<tr>"+"<th class='fc-agenda-axis "+a+"'>&nbsp;</th>";for(i=0;i<bB;i++){s+="<td class='fc- fc-col"+i+' '+b+"'>"+"<div>"+"<div class='fc-day-content'>"+"<div style='position:relative'>&nbsp;</div>"+"</div>"+"</div>"+"</td>"}s+="<td class='fc-agenda-gutter "+b+"'>&nbsp;</td>"+"</tr>"+"</tbody>"+"</table>";C=$(s).appendTo(l);D=C.find('thead');E=D.find('th').slice(1,-1);F=C.find('tbody');G=F.find('td').slice(0,-1);H=G.find('div.fc-day-content div');I=G.eq(0);J=I.find('> div');markFirstLast(D.add(D.find('tr')));markFirstLast(F.add(F.find('tr')));T=D.find('th:first');U=C.find('.fc-agenda-gutter');K=$("<div style='position:absolute;z-index:2;left:0;width:100%'/>").appendTo(l);if(q('allDaySlot')){L=$("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(K);s="<table style='width:100%' class='fc-agenda-allday' cellspacing='0'>"+"<tr>"+"<th class='"+a+" fc-agenda-axis'>"+q('allDayText')+"</th>"+"<td>"+"<div class='fc-day-content'><div style='position:relative'/></div>"+"</td>"+"<th class='"+a+" fc-agenda-gutter'>&nbsp;</th>"+"</tr>"+"</table>";M=$(s).appendTo(K);N=M.find('tr');dayBind(N.find('td'));T=T.add(M.find('th:first'));U=U.add(M.find('th.fc-agenda-gutter'));K.append("<div class='fc-agenda-divider "+a+"'>"+"<div class='fc-agenda-divider-inner'/>"+"</div>")}else{L=$([])}O=$("<div style='position:absolute;width:100%;overflow-x:hidden;overflow-y:auto'/>").appendTo(K);P=$("<div style='position:relative;width:100%;overflow:hidden'/>").appendTo(O);Q=$("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(P);s="<table class='fc-agenda-slots' style='width:100%' cellspacing='0'>"+"<tbody>";d=zeroDate();c=addMinutes(cloneDate(d),maxMinute);addMinutes(d,bL);bC=0;for(i=0;d<c;i++){e=d.getMinutes();s+="<tr class='fc-slot"+i+' '+(!e?'':'fc-minor')+"'>"+"<th class='fc-agenda-axis "+a+"'>"+((!f||!e)?B(d,q('axisFormat')):'&nbsp;')+"</th>"+"<td class='"+b+"'>"+"<div style='position:relative'>&nbsp;</div>"+"</td>"+"</tr>";addMinutes(d,q('slotMinutes'));bC++}s+="</tbody>"+"</table>";R=$(s).appendTo(P);S=R.find('div:first');slotBind(R.find('td'));T=T.add(R.find('th:first'))}function updateCells(){var i;var a;var b;var c;var d=clearTime(new Date());for(i=0;i<bB;i++){c=colDate(i);a=E.eq(i);a.html(B(c,bM));b=G.eq(i);if(+c==+d){b.addClass(bH+'-state-highlight fc-today')}else{b.removeClass(bH+'-state-highlight fc-today')}setDayID(a.add(b),c)}}function setHeight(a,b){if(a===bp){a=X}X=a;bG={};var c=F.position().top;var d=O.position().top;var e=Math.min(a-c,R.height()+d+1);J.height(e-vsides(I));K.css('top',c);O.height(e-d-1);bz=S.height()+1;if(b){resetScroll()}}function setWidth(b){W=b;bF.clear();Y=0;setOuterWidth(T.width('').each(function(i,a){Y=Math.max(Y,$(a).outerWidth())}),Y);var c=O[0].clientWidth;by=O.width()-c;if(by){setOuterWidth(U,by);U.show().prev().removeClass('fc-last')}else{U.hide().prev().addClass('fc-last')}Z=Math.floor((c-Y)/bB);setOuterWidth(E.slice(0,-1),Z)}function resetScroll(){var a=zeroDate();var b=cloneDate(a);b.setHours(q('firstHour'));var c=timePosition(a,b)+1;function scroll(){O.scrollTop(c)}scroll();setTimeout(scroll,0)}function beforeHide(){bA=O.scrollTop()}function afterShow(){O.scrollTop(bA)}function dayBind(a){a.click(slotClick).mousedown(z)}function slotBind(a){a.click(slotClick).mousedown(slotSelectionMousedown)}function slotClick(a){if(!q('selectable')){var b=Math.min(bB-1,Math.floor((a.pageX-C.offset().left-Y)/Z));var c=colDate(b);var d=this.parentNode.className.match(/fc-slot(\d+)/);if(d){var e=parseInt(d[1])*q('slotMinutes');var f=Math.floor(e/60);c.setHours(f);c.setMinutes(e%60+bL);r('dayClick',G[b],c,false,a)}else{r('dayClick',G[b],c,true,a)}}}function renderDayOverlay(a,b,c){if(c){bD.build()}var d=cloneDate(t.visStart);var e,endCol;if(bK){e=dayDiff(b,d)*dis+dit+1;endCol=dayDiff(a,d)*dis+dit+1}else{e=dayDiff(a,d);endCol=dayDiff(b,d)}e=Math.max(0,e);endCol=Math.min(bB,endCol);if(e<endCol){dayBind(renderCellOverlay(0,e,0,endCol-1))}}function renderCellOverlay(a,b,c,d){var e=bD.rect(a,b,c,d,K);return v(e,K)}function renderSlotOverlay(a,b){var c=cloneDate(t.visStart);var d=addDays(cloneDate(c),1);for(var i=0;i<bB;i++){var e=new Date(Math.max(c,a));var f=new Date(Math.min(d,b));if(e<f){var g=i*dis+dit;var h=bD.rect(0,g,0,g,P);var j=timePosition(c,e);var k=timePosition(c,f);h.top=j;h.height=k-j;slotBind(v(h,P))}addDays(c,1);addDays(d,1)}}bD=new CoordinateGrid(function(b,c){var e,n,p;E.each(function(i,a){e=$(a);n=e.offset().left;if(i){p[1]=n}p=[n];c[i]=p});p[1]=n+e.outerWidth();if(q('allDaySlot')){e=N;n=e.offset().top;b[0]=[n,n+e.outerHeight()]}var d=P.offset().top;var f=O.offset().top;var g=f+O.outerHeight();function constrain(n){return Math.max(f,Math.min(g,n))}for(var i=0;i<bC;i++){b.push([constrain(d+bz*i),constrain(d+bz*(i+1))])}});bE=new HoverListener(bD);bF=new HorizontalPositionCache(function(a){return H.eq(a)});function colContentLeft(a){return bF.left(a)}function colContentRight(a){return bF.right(a)}function dateCell(a){return{row:Math.floor(dayDiff(a,t.visStart)/7),col:dayOfWeekCol(a.getDay())}}function cellDate(a){var d=colDate(a.col);var b=a.row;if(q('allDaySlot')){b--}if(b>=0){addMinutes(d,bL+b*q('slotMinutes'))}return d}function colDate(a){return addDays(cloneDate(t.visStart),a*dis+dit)}function cellIsAllDay(a){return q('allDaySlot')&&!a.row}function dayOfWeekCol(a){return((a-Math.max(bI,bJ)+bB)%bB)*dis+dit}function timePosition(a,b){a=cloneDate(a,true);if(b<addMinutes(cloneDate(a),bL)){return 0}if(b>=addMinutes(cloneDate(a),maxMinute)){return R.height()}var c=q('slotMinutes'),minutes=b.getHours()*60+b.getMinutes()-bL,slotI=Math.floor(minutes/c),slotTop=bG[slotI];if(slotTop===bp){slotTop=bG[slotI]=R.find('tr:eq('+slotI+') td div')[0].offsetTop}return Math.max(0,Math.round(slotTop-1+bz*((minutes%c)/c)))}function allDayBounds(){return{left:Y,right:W-by}}function getAllDayRow(a){return N}function defaultEventEnd(a){var b=cloneDate(a.start);if(a.allDay){return b}return addMinutes(b,q('defaultEventMinutes'))}function defaultSelectionEnd(a,b){if(b){return cloneDate(a)}return addMinutes(cloneDate(a),q('slotMinutes'))}function renderSelection(a,b,c){if(c){if(q('allDaySlot')){renderDayOverlay(a,addDays(cloneDate(b),1),true)}}else{renderSlotSelection(a,b)}}function renderSlotSelection(a,b){var c=q('selectHelper');bD.build();if(c){var d=dayDiff(a,t.visStart)*dis+dit;if(d>=0&&d<bB){var e=bD.rect(0,d,0,d,P);var f=timePosition(a,a);var g=timePosition(a,b);if(g>f){e.top=f;e.height=g-f;e.left+=2;e.width-=5;if($.isFunction(c)){var h=c(a,b);if(h){e.position='absolute';e.zIndex=8;V=$(h).css(e).appendTo(P)}}else{e.isStart=true;e.isEnd=true;V=$(A({title:'',start:a,end:b,className:['fc-select-helper'],editable:false},e));V.css('opacity',q('dragOpacity'))}if(V){slotBind(V);P.append(V);setOuterWidth(V,e.width,true);setOuterHeight(V,e.height,true)}}}}else{renderSlotOverlay(a,b)}}function clearSelection(){w();if(V){V.remove();V=null}}function slotSelectionMousedown(e){if(e.which==1&&q('selectable')){y(e);var f;bE.start(function(a,b){clearSelection();if(a&&a.col==b.col&&!cellIsAllDay(a)){var c=cellDate(b);var d=cellDate(a);f=[c,addMinutes(cloneDate(c),q('slotMinutes')),d,addMinutes(cloneDate(d),q('slotMinutes'))].sort(cmp);renderSlotSelection(f[0],f[3])}else{f=null}},e);$(document).one('mouseup',function(a){bE.stop();if(f){if(+f[0]==+f[1]){reportDayClick(f[0],false,a)}x(f[0],f[3],false,a)}})}}function reportDayClick(a,b,c){r('dayClick',G[dayOfWeekCol(a.getDay())],a,b,c)}function dragStart(d,e,f){bE.start(function(a){w();if(a){if(cellIsAllDay(a)){renderCellOverlay(a.row,a.col,a.row,a.col)}else{var b=cellDate(a);var c=addMinutes(cloneDate(b),q('defaultEventMinutes'));renderSlotOverlay(b,c)}}},e)}function dragStop(a,b,c){var d=bE.stop();w();if(d){r('drop',a,cellDate(d),cellIsAllDay(d),b,c)}}}function AgendaEventRenderer(){var t=this;t.renderEvents=renderEvents;t.compileDaySegs=compileDaySegs;t.clearEvents=clearEvents;t.slotSegHtml=slotSegHtml;t.bindDaySeg=bindDaySeg;DayEventRenderer.call(t);var u=t.opt;var v=t.trigger;var w=t.isEventDraggable;var x=t.isEventResizable;var y=t.eventEnd;var z=t.reportEvents;var A=t.reportEventClear;var B=t.eventElementHandlers;var C=t.setHeight;var D=t.getDaySegmentContainer;var E=t.getSlotSegmentContainer;var F=t.getHoverListener;var G=t.getMaxMinute;var H=t.getMinMinute;var I=t.timePosition;var J=t.colContentLeft;var K=t.colContentRight;var L=t.renderDaySegs;var M=t.resizableDayEvent;var N=t.getColCnt;var O=t.getColWidth;var P=t.getSlotHeight;var Q=t.getBodyContent;var R=t.reportEventElement;var S=t.showEvents;var T=t.hideEvents;var U=t.eventDrop;var V=t.eventResize;var W=t.renderDayOverlay;var X=t.clearOverlays;var Y=t.calendar;var Z=Y.formatDate;var by=Y.formatDates;function renderEvents(a,b){z(a);var i,len=a.length,dayEvents=[],slotEvents=[];for(i=0;i<len;i++){if(a[i].allDay){dayEvents.push(a[i])}else{slotEvents.push(a[i])}}if(u('allDaySlot')){L(compileDaySegs(dayEvents),b);C()}renderSlotSegs(compileSlotSegs(slotEvents),b)}function clearEvents(){A();D().empty();E().empty()}function compileDaySegs(a){var b=stackSegs(sliceSegs(a,$.map(a,exclEndDay),t.visStart,t.visEnd)),i,levelCnt=b.length,level,j,seg,segs=[];for(i=0;i<levelCnt;i++){level=b[i];for(j=0;j<level.length;j++){seg=level[j];seg.row=0;seg.level=i;segs.push(seg)}}return segs}function compileSlotSegs(a){var b=N(),minMinute=H(),maxMinute=G(),d=addMinutes(cloneDate(t.visStart),minMinute),visEventEnds=$.map(a,slotEventEnd),i,col,j,level,k,seg,segs=[];for(i=0;i<b;i++){col=stackSegs(sliceSegs(a,visEventEnds,d,addMinutes(cloneDate(d),maxMinute-minMinute)));countForwardSegs(col);for(j=0;j<col.length;j++){level=col[j];for(k=0;k<level.length;k++){seg=level[k];seg.col=i;seg.level=j;segs.push(seg)}}addDays(d,1,true)}return segs}function slotEventEnd(a){if(a.end){return cloneDate(a.end)}else{return addMinutes(cloneDate(a.start),u('defaultEventMinutes'))}}function renderSlotSegs(a,b){var i,segCnt=a.length,seg,event,classes,top,bottom,colI,levelI,forward,leftmost,availWidth,outerWidth,left,html='',eventElements,eventElement,triggerRes,vsideCache={},hsideCache={},key,val,contentElement,height,slotSegmentContainer=E(),rtl,dis,dit,colCnt=N();if(rtl=u('isRTL')){dis=-1;dit=colCnt-1}else{dis=1;dit=0}for(i=0;i<segCnt;i++){seg=a[i];event=seg.event;top=I(seg.start,seg.start);bottom=I(seg.start,seg.end);colI=seg.col;levelI=seg.level;forward=seg.forward||0;leftmost=J(colI*dis+dit);availWidth=K(colI*dis+dit)-leftmost;availWidth=Math.min(availWidth-6,availWidth*.95);if(levelI){outerWidth=availWidth/(levelI+forward+1)}else{if(forward){outerWidth=((availWidth/(forward+1))-(12/2))*2}else{outerWidth=availWidth}}left=leftmost+(availWidth/(levelI+forward+1)*levelI)*dis+(rtl?availWidth-outerWidth:0);seg.top=top;seg.left=left;seg.outerWidth=outerWidth;seg.outerHeight=bottom-top;html+=slotSegHtml(event,seg)}slotSegmentContainer[0].innerHTML=html;eventElements=slotSegmentContainer.children();for(i=0;i<segCnt;i++){seg=a[i];event=seg.event;eventElement=$(eventElements[i]);triggerRes=v('eventRender',event,event,eventElement);if(triggerRes===false){eventElement.remove()}else{if(triggerRes&&triggerRes!==true){eventElement.remove();eventElement=$(triggerRes).css({position:'absolute',top:seg.top,left:seg.left}).appendTo(slotSegmentContainer)}seg.element=eventElement;if(event._id===b){bindSlotSeg(event,eventElement,seg)}else{eventElement[0]._fci=i}R(event,eventElement)}}lazySegBind(slotSegmentContainer,a,bindSlotSeg);for(i=0;i<segCnt;i++){seg=a[i];if(eventElement=seg.element){val=vsideCache[key=seg.key=cssKey(eventElement[0])];seg.vsides=val===bp?(vsideCache[key]=vsides(eventElement,true)):val;val=hsideCache[key];seg.hsides=val===bp?(hsideCache[key]=hsides(eventElement,true)):val;contentElement=eventElement.find('div.fc-event-content');if(contentElement.length){seg.contentTop=contentElement[0].offsetTop}}}for(i=0;i<segCnt;i++){seg=a[i];if(eventElement=seg.element){eventElement[0].style.width=Math.max(0,seg.outerWidth-seg.hsides)+'px';height=Math.max(0,seg.outerHeight-seg.vsides);eventElement[0].style.height=height+'px';event=seg.event;if(seg.contentTop!==bp&&height-seg.contentTop<10){eventElement.find('div.fc-event-time').text(Z(event.start,u('timeFormat'))+' - '+event.title);eventElement.find('div.fc-event-title').remove()}v('eventAfterRender',event,event,eventElement)}}}function slotSegHtml(a,b){var c="<";var d=a.url;var e=getSkinCss(a,u);var f=(e?" style='"+e+"'":'');var g=['fc-event','fc-event-skin','fc-event-vert'];if(w(a)){g.push('fc-event-draggable')}if(b.isStart){g.push('fc-corner-top')}if(b.isEnd){g.push('fc-corner-bottom')}g=g.concat(a.className);if(a.source){g=g.concat(a.source.className||[])}if(d){c+="a href='"+htmlEscape(a.url)+"'"}else{c+="div"}c+=" class='"+g.join(' ')+"'"+" style='position:absolute;z-index:8;top:"+b.top+"px;left:"+b.left+"px;"+e+"'"+">"+"<div class='fc-event-inner fc-event-skin'"+f+">"+"<div class='fc-event-head fc-event-skin'"+f+">"+"<div class='fc-event-time'>"+htmlEscape(by(a.start,a.end,u('timeFormat')))+"</div>"+"</div>"+"<div class='fc-event-content'>"+"<div class='fc-event-title'>"+htmlEscape(a.title)+"</div>"+"</div>"+"<div class='fc-event-bg'></div>"+"</div>";if(b.isEnd&&x(a)){c+="<div class='ui-resizable-handle ui-resizable-s'>=</div>"}c+="</"+(d?"a":"div")+">";return c}function bindDaySeg(a,b,c){if(w(a)){draggableDayEvent(a,b,c.isStart)}if(c.isEnd&&x(a)){M(a,b,c)}B(a,b)}function bindSlotSeg(a,b,c){var d=b.find('div.fc-event-time');if(w(a)){draggableSlotEvent(a,b,d)}if(c.isEnd&&x(a)){resizableSlotEvent(a,b,d)}B(a,b)}function draggableDayEvent(g,h,i){var j;var k;var l=true;var m;var n=u('isRTL')?-1:1;var o=F();var p=O();var q=P();var r=H();h.draggable({zIndex:9,opacity:u('dragOpacity','month'),revertDuration:u('dragRevertDuration'),start:function(e,f){v('eventDragStart',h,g,e,f);T(g,h);j=h.width();o.start(function(a,b,c,d){X();if(a){k=false;m=d*n;if(!a.row){W(addDays(cloneDate(g.start),m),addDays(exclEndDay(g),m));resetElement()}else{if(i){if(l){h.width(p-10);setOuterHeight(h,q*Math.round((g.end?((g.end-g.start)/MINUTE_MS):u('defaultEventMinutes'))/u('slotMinutes')));h.draggable('option','grid',[p,1]);l=false}}else{k=true}}k=k||(l&&!m)}else{resetElement();k=true}h.draggable('option','revert',k)},e,'drag')},stop:function(a,b){o.stop();X();v('eventDragStop',h,g,a,b);if(k){resetElement();h.css('filter','');S(g,h)}else{var c=0;if(!l){c=Math.round((h.offset().top-Q().offset().top)/q)*u('slotMinutes')+r-(g.start.getHours()*60+g.start.getMinutes())}U(this,g,m,c,l,a,b)}}});function resetElement(){if(!l){h.width(j).height('').draggable('option','grid',null);l=true}}}function draggableSlotEvent(g,h,i){var j;var k=false;var l;var m;var n;var o=u('isRTL')?-1:1;var p=F();var q=N();var r=O();var s=P();h.draggable({zIndex:9,scroll:false,grid:[r,s],axis:q==1?'y':false,opacity:u('dragOpacity'),revertDuration:u('dragRevertDuration'),start:function(e,f){var e=e.originalEvent;v('eventDragStart',h,g,e,f);T(g,h);j=h.position();m=n=0;p.start(function(a,b,c,d){h.draggable('option','revert',!a);X();if(a){l=d*o;if(u('allDaySlot')&&!a.row){if(!k){k=true;i.hide();h.draggable('option','grid',null)}W(addDays(cloneDate(g.start),l),addDays(exclEndDay(g),l))}else{resetElement()}}},e,'drag')},drag:function(a,b){var a=a.originalEvent;m=Math.round((b.position.top-j.top)/s)*u('slotMinutes');if(m!=n){if(!k){updateTimeText(m)}n=m}},stop:function(a,b){var a=a.originalEvent;var c=p.stop();X();v('eventDragStop',h,g,a,b);if(c&&(l||m||k)){U(this,g,l,k?0:m,k,a,b)}else{resetElement();h.css('filter','');h.css(j);updateTimeText(0);S(g,h)}}});function updateTimeText(a){var b=addMinutes(cloneDate(g.start),a);var c;if(g.end){c=addMinutes(cloneDate(g.end),a)}i.text(by(b,c,u('timeFormat')))}function resetElement(){if(k){i.css('display','');h.draggable('option','grid',[r,s]);k=false}}}function resizableSlotEvent(c,d,e){var f,prevSlotDelta;var g=P();d.resizable({handles:{s:'div.ui-resizable-s'},grid:g,start:function(a,b){f=prevSlotDelta=0;T(c,d);d.css('z-index',9);v('eventResizeStart',this,c,a,b)},resize:function(a,b){f=Math.round((Math.max(g,d.height())-b.originalSize.height)/g);if(f!=prevSlotDelta){e.text(by(c.start,(!f&&!c.end)?null:addMinutes(y(c),u('slotMinutes')*f),u('timeFormat')));prevSlotDelta=f}},stop:function(a,b){v('eventResizeStop',this,c,a,b);if(f){V(this,c,0,u('slotMinutes')*f,a,b)}else{d.css('z-index',8);S(c,d)}}})}}function countForwardSegs(a){var i,j,k,level,segForward,segBack;for(i=a.length-1;i>0;i--){level=a[i];for(j=0;j<level.length;j++){segForward=level[j];for(k=0;k<a[i-1].length;k++){segBack=a[i-1][k];if(segsCollide(segForward,segBack)){segBack.forward=Math.max(segBack.forward||0,(segForward.forward||0)+1)}}}}}function View(j,k,l){var t=this;t.element=j;t.calendar=k;t.name=l;t.opt=opt;t.trigger=trigger;t.isEventDraggable=isEventDraggable;t.isEventResizable=isEventResizable;t.reportEvents=reportEvents;t.eventEnd=eventEnd;t.reportEventElement=reportEventElement;t.reportEventClear=reportEventClear;t.eventElementHandlers=eventElementHandlers;t.showEvents=showEvents;t.hideEvents=hideEvents;t.eventDrop=eventDrop;t.eventResize=eventResize;var m=t.defaultEventEnd;var n=k.normalizeEvent;var o=k.reportEventChange;var p={};var q=[];var r={};var s=k.options;function opt(a,b){var v=s[a];if(typeof v=='object'){return smartProperty(v,b||l)}return v}function trigger(a,b){return k.trigger.apply(k,[a,b||t].concat(Array.prototype.slice.call(arguments,2),[t]))}function isEventDraggable(a){return isEventEditable(a)&&!opt('disableDragging')}function isEventResizable(a){return isEventEditable(a)&&!opt('disableResizing')}function isEventEditable(a){return firstDefined(a.editable,(a.source||{}).editable,opt('editable'))}function reportEvents(a){p={};var i,len=a.length,event;for(i=0;i<len;i++){event=a[i];if(p[event._id]){p[event._id].push(event)}else{p[event._id]=[event]}}}function eventEnd(a){return a.end?cloneDate(a.end):m(a)}function reportEventElement(a,b){q.push(b);if(r[a._id]){r[a._id].push(b)}else{r[a._id]=[b]}}function reportEventClear(){q=[];r={}}function eventElementHandlers(b,c){c.click(function(a){if(!c.hasClass('ui-draggable-dragging')&&!c.hasClass('ui-resizable-resizing')){return trigger('eventClick',this,b,a)}}).hover(function(a){trigger('eventMouseover',this,b,a)},function(a){trigger('eventMouseout',this,b,a)})}function showEvents(a,b){eachEventElement(a,b,'show')}function hideEvents(a,b){eachEventElement(a,b,'hide')}function eachEventElement(a,b,c){var d=r[a._id],i,len=d.length;for(i=0;i<len;i++){if(!b||d[i][0]!=b[0]){d[i][c]()}}}function eventDrop(e,a,b,c,d,f,g){var h=a.allDay;var i=a._id;moveEvents(p[i],b,c,d);trigger('eventDrop',e,a,b,c,d,function(){moveEvents(p[i],-b,-c,h);o(i)},f,g);o(i)}function eventResize(e,a,b,c,d,f){var g=a._id;elongateEvents(p[g],b,c);trigger('eventResize',e,a,b,c,function(){elongateEvents(p[g],-b,-c);o(g)},d,f);o(g)}function moveEvents(a,b,c,d){c=c||0;for(var e,len=a.length,i=0;i<len;i++){e=a[i];if(d!==bp){e.allDay=d}addMinutes(addDays(e.start,b,true),c);if(e.end){e.end=addMinutes(addDays(e.end,b,true),c)}n(e,s)}}function elongateEvents(a,b,c){c=c||0;for(var e,len=a.length,i=0;i<len;i++){e=a[i];e.end=addMinutes(addDays(eventEnd(e),b,true),c);n(e,s)}}}function DayEventRenderer(){var t=this;t.renderDaySegs=renderDaySegs;t.resizableDayEvent=resizableDayEvent;var z=t.opt;var A=t.trigger;var B=t.isEventDraggable;var C=t.isEventResizable;var D=t.eventEnd;var E=t.reportEventElement;var F=t.showEvents;var G=t.hideEvents;var H=t.eventResize;var I=t.getRowCnt;var J=t.getColCnt;var K=t.getColWidth;var L=t.allDayRow;var M=t.allDayBounds;var N=t.colContentLeft;var O=t.colContentRight;var P=t.dayOfWeekCol;var Q=t.dateCell;var R=t.compileDaySegs;var S=t.getDaySegmentContainer;var T=t.bindDaySeg;var U=t.calendar.formatDates;var V=t.renderDayOverlay;var W=t.clearOverlays;var X=t.clearSelection;function renderDaySegs(a,b){var c=S();var d;var e=I();var f=J();var i=0;var g;var h;var l;var j;var m=a.length;var n;var o;var k;c[0].innerHTML=daySegHTML(a);daySegElementResolve(a,c.children());daySegElementReport(a);daySegHandlers(a,c,b);daySegCalcHSides(a);daySegSetWidths(a);daySegCalcHeights(a);d=getRowDivs();for(g=0;g<e;g++){h=0;l=[];for(j=0;j<f;j++){l[j]=0}while(i<m&&(n=a[i]).row==g){o=arrayMax(l.slice(n.startCol,n.endCol));n.top=o;o+=n.outerHeight;for(k=n.startCol;k<n.endCol;k++){l[k]=o}i++}d[g].height(arrayMax(l))}daySegSetTops(a,getRowTops(d))}function renderTempDaySegs(a,b,c){var d=$("<div/>");var e;var f=S();var i;var g=a.length;var h;d[0].innerHTML=daySegHTML(a);e=d.children();f.append(e);daySegElementResolve(a,e);daySegCalcHSides(a);daySegSetWidths(a);daySegCalcHeights(a);daySegSetTops(a,getRowTops(getRowDivs()));e=[];for(i=0;i<g;i++){h=a[i].element;if(h){if(a[i].row===b){h.css('top',c)}e.push(h[0])}}return $(e)}function daySegHTML(a){var b=z('isRTL');var i;var c=a.length;var d;var e;var f;var g;var h=M();var j=h.left;var k=h.right;var l;var m;var n;var o;var p;var q='';for(i=0;i<c;i++){d=a[i];e=d.event;g=['fc-event','fc-event-skin','fc-event-hori'];if(B(e)){g.push('fc-event-draggable')}if(b){if(d.isStart){g.push('fc-corner-right')}if(d.isEnd){g.push('fc-corner-left')}l=P(d.end.getDay()-1);m=P(d.start.getDay());n=d.isEnd?N(l):j;o=d.isStart?O(m):k}else{if(d.isStart){g.push('fc-corner-left')}if(d.isEnd){g.push('fc-corner-right')}l=P(d.start.getDay());m=P(d.end.getDay()-1);n=d.isStart?N(l):j;o=d.isEnd?O(m):k}g=g.concat(e.className);if(e.source){g=g.concat(e.source.className||[])}f=e.url;p=getSkinCss(e,z);if(f){q+="<a href='"+htmlEscape(f)+"'"}else{q+="<div"}q+=" class='"+g.join(' ')+"'"+" style='position:absolute;z-index:8;left:"+n+"px;"+p+"'"+">"+"<div"+" class='fc-event-inner fc-event-skin'"+(p?" style='"+p+"'":'')+">";if(!e.allDay&&d.isStart){q+="<span class='fc-event-time'>"+htmlEscape(U(e.start,e.end,z('timeFormat')))+"</span>"}q+="<span class='fc-event-title'>"+htmlEscape(e.title)+"</span>"+"</div>";if(d.isEnd&&C(e)){q+="<div class='ui-resizable-handle ui-resizable-"+(b?'w':'e')+"'>"+"&nbsp;&nbsp;&nbsp;"+"</div>"}q+="</"+(f?"a":"div")+">";d.left=n;d.outerWidth=o-n;d.startCol=l;d.endCol=m+1}return q}function daySegElementResolve(a,b){var i;var c=a.length;var d;var e;var f;var g;for(i=0;i<c;i++){d=a[i];e=d.event;f=$(b[i]);g=A('eventRender',e,e,f);if(g===false){f.remove()}else{if(g&&g!==true){g=$(g).css({position:'absolute',left:d.left});f.replaceWith(g);f=g}d.element=f}}}function daySegElementReport(a){var i;var b=a.length;var c;var d;for(i=0;i<b;i++){c=a[i];d=c.element;if(d){E(c.event,d)}}}function daySegHandlers(a,b,c){var i;var d=a.length;var e;var f;var g;for(i=0;i<d;i++){e=a[i];f=e.element;if(f){g=e.event;if(g._id===c){T(g,f,e)}else{f[0]._fci=i}}}lazySegBind(b,a,T)}function daySegCalcHSides(a){var i;var b=a.length;var c;var d;var e,val;var f={};for(i=0;i<b;i++){c=a[i];d=c.element;if(d){e=c.key=cssKey(d[0]);val=f[e];if(val===bp){val=f[e]=hsides(d,true)}c.hsides=val}}}function daySegSetWidths(a){var i;var b=a.length;var c;var d;for(i=0;i<b;i++){c=a[i];d=c.element;if(d){d[0].style.width=Math.max(0,c.outerWidth-c.hsides)+'px'}}}function daySegCalcHeights(a){var i;var b=a.length;var c;var d;var e,val;var f={};for(i=0;i<b;i++){c=a[i];d=c.element;if(d){e=c.key;val=f[e];if(val===bp){val=f[e]=vmargins(d)}c.outerHeight=d[0].offsetHeight+val}}}function getRowDivs(){var i;var a=I();var b=[];for(i=0;i<a;i++){b[i]=L(i).find('td:first div.fc-day-content > div')}return b}function getRowTops(a){var i;var b=a.length;var c=[];for(i=0;i<b;i++){c[i]=a[i][0].offsetTop}return c}function daySegSetTops(a,b){var i;var c=a.length;var d;var e;var f;for(i=0;i<c;i++){d=a[i];e=d.element;if(e){e[0].style.top=b[d.row]+(d.top||0)+'px';f=d.event;A('eventAfterRender',f,f,e)}}}function resizableDayEvent(q,s,u){var v=z('isRTL');var w=v?'w':'e';var x=s.find('div.ui-resizable-'+w);var y=false;disableTextSelection(s);s.mousedown(function(a){a.preventDefault()}).click(function(a){if(y){a.preventDefault();a.stopImmediatePropagation()}});x.mousedown(function(f){if(f.which!=1){return}y=true;var g=t.getHoverListener();var h=I();var i=J();var j=v?-1:1;var k=v?i-1:0;var l=s.css('top');var m;var n;var o=$.extend({},q);var p=Q(q.start);X();$('body').css('cursor',w+'-resize').one('mouseup',mouseup);A('eventResizeStart',this,q,f);g.start(function(a,b){if(a){var r=Math.max(p.row,a.row);var c=a.col;if(h==1){r=0}if(r==p.row){if(v){c=Math.min(p.col,c)}else{c=Math.max(p.col,c)}}m=(r*7+c*j+k)-(b.row*7+b.col*j+k);var d=addDays(D(q),m,true);if(m){o.end=d;var e=n;n=renderTempDaySegs(R([o]),u.row,l);n.find('*').css('cursor',w+'-resize');if(e){e.remove()}G(q)}else{if(n){F(q);n.remove();n=null}}W();V(q.start,addDays(cloneDate(d),1))}},f);function mouseup(a){A('eventResizeStop',this,q,a);$('body').css('cursor','');g.stop();W();if(m){H(this,q,m,0,a)}setTimeout(function(){y=false},0)}})}}function SelectionManager(){var t=this;t.select=select;t.unselect=unselect;t.reportSelection=reportSelection;t.daySelectionMousedown=daySelectionMousedown;var j=t.opt;var k=t.trigger;var l=t.defaultSelectionEnd;var m=t.renderSelection;var n=t.clearSelection;var o=false;if(j('selectable')&&j('unselectAuto')){$(document).mousedown(function(a){var b=j('unselectCancel');if(b){if($(a.target).parents(b).length){return}}unselect(a)})}function select(a,b,c){unselect();if(!b){b=l(a,c)}m(a,b,c);reportSelection(a,b,c)}function unselect(a){if(o){o=false;n();k('unselect',null,a)}}function reportSelection(a,b,c,d){o=true;k('select',null,a,b,c,d)}function daySelectionMousedown(c){var d=t.cellDate;var e=t.cellIsAllDay;var f=t.getHoverListener();var g=t.reportDayClick;if(c.which==1&&j('selectable')){unselect(c);var h=this;var i;f.start(function(a,b){n();if(a&&e(a)){i=[d(b),d(a)].sort(cmp);m(i[0],i[1],true)}else{i=null}},c);$(document).one('mouseup',function(a){f.stop();if(i){if(+i[0]==+i[1]){g(i[0],true,a)}reportSelection(i[0],i[1],true,a)}})}}}function OverlayManager(){var t=this;t.renderOverlay=renderOverlay;t.clearOverlays=clearOverlays;var c=[];var d=[];function renderOverlay(a,b){var e=d.shift();if(!e){e=$("<div class='fc-cell-overlay' style='position:absolute;z-index:3'/>")}if(e[0].parentNode!=b[0]){e.appendTo(b)}c.push(e.css(a).show());return e}function clearOverlays(){var e;while(e=c.shift()){d.push(e.hide().unbind())}}}function CoordinateGrid(g){var t=this;var h;var j;t.build=function(){h=[];j=[];g(h,j)};t.cell=function(x,y){var a=h.length;var b=j.length;var i,r=-1,c=-1;for(i=0;i<a;i++){if(y>=h[i][0]&&y<h[i][1]){r=i;break}}for(i=0;i<b;i++){if(x>=j[i][0]&&x<j[i][1]){c=i;break}}return(r>=0&&c>=0)?{row:r,col:c}:null};t.rect=function(a,b,c,d,e){var f=e.offset();return{top:h[a][0]-f.top,left:j[b][0]-f.left,width:j[d][1]-j[b][0],height:h[c][1]-h[a][0]}}}function HoverListener(d){var t=this;var e;var f;var g;var h;t.start=function(a,b,c){f=a;g=h=null;d.build();mouse(b);e=c||'mousemove';$(document).bind(e,mouse)};function mouse(a){var a=a.originalEvent;var b=d.cell(a.pageX,a.pageY);if(!b!=!h||b&&(b.row!=h.row||b.col!=h.col)){if(b){if(!g){g=b}f(b,g,b.row-g.row,b.col-g.col)}else{f(b,g)}h=b}}t.stop=function(){$(document).unbind(e,mouse);return h}}function HorizontalPositionCache(a){var t=this,elements={},lefts={},rights={};function e(i){return elements[i]=elements[i]||a(i)}t.left=function(i){return lefts[i]=lefts[i]===bp?e(i).position().left:lefts[i]};t.right=function(i){return rights[i]=rights[i]===bp?t.left(i)+e(i).width():rights[i]};t.clear=function(){elements={};lefts={};rights={}}}})(jQuery);