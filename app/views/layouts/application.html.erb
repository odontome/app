<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <meta name="msapplication-TileColor" content="#206bc4" />
    <meta name="theme-color" content="#206bc4" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
	  <title>Odonto.me</title>
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag "application" %>
    <%= javascript_include_tag "application" %>
    
    <script>
      // Theme Switcher functionality
      document.addEventListener('DOMContentLoaded', function() {
        const themeToggle = document.getElementById('theme-toggle');
        const themeText = document.getElementById('theme-text');
        const lightIcon = document.querySelector('.light-icon');
        const darkIcon = document.querySelector('.dark-icon');
        const body = document.body;

        // Get current theme from localStorage or default to light
        const currentTheme = localStorage.getItem('theme') || 'light';
        
        // Apply the current theme
        applyTheme(currentTheme);

        // Theme toggle click handler
        if (themeToggle) {
          themeToggle.addEventListener('click', function(e) {
            e.preventDefault();
            const newTheme = body.classList.contains('theme-dark') ? 'light' : 'dark';
            applyTheme(newTheme);
            localStorage.setItem('theme', newTheme);
          });
        }

        function applyTheme(theme) {
          if (theme === 'dark') {
            body.classList.remove('theme-light');
            body.classList.add('theme-dark');
            if (themeText) themeText.textContent = 'Light Mode';
            if (lightIcon) lightIcon.style.display = 'none';
            if (darkIcon) darkIcon.style.display = 'inline';
          } else {
            body.classList.remove('theme-dark');
            body.classList.add('theme-light');
            if (themeText) themeText.textContent = 'Dark Mode';
            if (lightIcon) lightIcon.style.display = 'inline';
            if (darkIcon) darkIcon.style.display = 'none';
          }
        }
      });
    </script>

	  <link rel="shortcut icon" href="/favicon.ico">
</head>

<body class="theme-light" id="app-body">
  <!-- Inline script to prevent flash of unstyled content -->
  <script>
    (function() {
      const theme = localStorage.getItem('theme') || 'light';
      const body = document.getElementById('app-body');
      if (theme === 'dark') {
        body.classList.remove('theme-light');
        body.classList.add('theme-dark');
      }
    })();
  </script>
  <div class="page">
    <%= render "shared/navigation" %>

    <div class="page-wrapper">
      <div class="container-fluid">
        <%= render "shared/flash_messages" %>
        <%= yield %>
      </div>

      <%= render "shared/footer" %>
    </div>
  </div>
</body>
</html>
